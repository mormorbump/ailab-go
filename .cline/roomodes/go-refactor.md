---
name: Go:RefactorMode
groups:
  - read
  - edit
  - browser
  - command
  - mcp
source: "project"
---

## リファクターモード

リファクターモードは、既存のコードを改善するためのモードです。

### 静的解析ツールの活用

1. **go vet**
   - 標準の静的解析ツール
   - 潜在的なバグや問題を検出
   ```bash
   go vet ./...
   ```

2. **golangci-lint**
   - 複数のリンターを統合したツール
   - コードスタイル、潜在的なバグ、パフォーマンス問題などを検出
   ```bash
   golangci-lint run --enable=gocognit,gocritic,gocyclo,godot,godox,misspell
   ```

### デッドコードの検出

1. **未使用のコード**
   - 未使用の変数、関数、型などを検出
   ```bash
   go vet -unusedresult ./...
   ```

2. **未使用の依存関係**
   - 未使用のインポートパッケージを検出
   ```bash
   go mod tidy
   ```

3. **サードパーティツール**
   - より高度な静的解析
   ```bash
   staticcheck ./...
   ```

### リファクタリングの手順

1. **テストの確認**
   - リファクタリング前にすべてのテストが通過することを確認
   ```bash
   go test ./...
   ```

2. **コードの分析**
   - 静的解析ツールを実行
   - 複雑度の高い部分を特定
   - 重複コードを特定

3. **リファクタリングの実施**
   - 小さな変更を段階的に行う
   - 各変更後にテストを実行
   - コードの動作を変えないよう注意

4. **最終確認**
   - すべてのテストが通過することを確認
   - 静的解析ツールを再実行
   - パフォーマンスの確認（必要に応じて）

### リファクタリングの種類

1. **コードの整理**
   - 命名の改善
   - コメントの追加・更新
   - フォーマットの統一

2. **構造の改善**
   - 関数の分割
   - インターフェースの抽出
   - 責任の分離

3. **パフォーマンスの最適化**
   - アルゴリズムの改善
   - メモリ使用量の削減
   - 並行処理の導入

### リファクタリングのベストプラクティス

1. **テストファーストアプローチ**
   - リファクタリング前にテストを充実させる
   - テストカバレッジを確認

2. **段階的な変更**
   - 一度に大きな変更を行わない
   - 各ステップでテストを実行

3. **バージョン管理の活用**
   - 小さなコミットに分ける
   - 明確なコミットメッセージを書く

4. **ドキュメントの更新**
   - 変更に合わせてドキュメントを更新
   - APIの変更がある場合は特に注意